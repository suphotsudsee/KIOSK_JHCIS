import{_ as A}from"./nav.vue.0f5d62e9.js";import{_ as F}from"./nuxt-link.fdbe223f.js";import{_ as G}from"./cardId.vue.df2be853.js";import{a as R,h as u,r as k,b as x,f as z,i as E,o as S,j as $,k as r,z as K,A as L,u as _,B as U,y as H,q as y,w as J,F as O}from"./entry.d3560666.js";import{b as Q}from"./usePatient.fcdb521f.js";import{u as W}from"./useNhso.fcac39c9.js";import{u as X,a as Y}from"./useVisit.fb02c9a9.js";import{S as C}from"./sweetalert2.all.30a4a880.js";import"./composables.002676a1.js";import"./fetch.66222654.js";const Z={class:"block w-5/6 mx-20 mt-10 min-h-full p-6 bg-white border border-gray-200 rounded-lg shadow"},ee={class:"mb-10"},re=r("label",{for:"tel",class:"block mb-2 text-3xl font-medium text-gray-900 dark:text-white"},"เบอร์โทรศัพท์",-1),oe={class:"grid grid-cols-3 gap-4"},te=r("div",null,null,-1),ae={class:"flex justify-center"},ne=["disabled"],le=R({__name:"phone",setup(M){const m=u(null),a=u(""),t=k(x("personState")),c=z(),v=u(!0),V=u("PG0060001"),g=k(x("patientClaim")),I=u(!0),N=k(x("visitState"));E(()=>{t.value.mobile&&(a.value=t.value.mobile.trim(),a.value.length===10&&(v.value=!1)),D()});const D=()=>{m.value.focus()},d=u({pid:"",claimType:"",mobile:"",correlationId:"",hn:"",hcode:""}),n=u({pcucode:"",pid:"",rightcode:null,rightno:null,hosmain:null,hossub:null,username:"",claimcode_nhso:"",claimcode_type:"",datetime_claim:""}),i=l=>{a.value.length<10&&(console.log(l),a.value+=l,console.log(a.value),a.value.length===10&&(v.value=!1))},B=()=>{a.value=a.value.substring(0,a.value.length-1)},P=async()=>{var l;if(console.log(a.value.length),I.value=!0,a.value.length===10&&t.value.pid){const e=u({pid:t.value.pid,mobile:a.value}),{data:o,pending:f,error:p,refresh:b}=await Q(e.value);(l=o.value)!=null&&l.ok&&(console.log(o.value),t.value.mobile=o.value.data.mobile,t.value.telephoneperson=o.value.data.mobile,await q())}},T=l=>{console.log(l),l[0].code==="KioskClaimNotDuplicateInSameDay"?C.fire({icon:"error",title:"ไม่สามารถเลือกบริการซ้ำใน 1 วัน",text:"กรุณาเลือกเปิด Service โดยไม่ Authen"}).then(()=>{c.push("/")}):C.fire({icon:"error",title:"ไม่สามารถติดต่อไปยัง Nhso ได้",text:"กรุณาลองใหม่อีกครั้ง..."}).then(()=>{c.push("/")})},q=async()=>{var l,e,o,f,p;if(t.value){d.value.pid=t.value.idcard,d.value.hcode=t.value.pcucodeperson,d.value.hn=t.value.pid.toString(),d.value.claimType=V.value,t.value.mobile?d.value.mobile=t.value.mobile:d.value.mobile="0000000000",g.value.correlationId&&(d.value.correlationId=g.value.correlationId);const{data:b,pending:se,error:h,refresh:ge}=await W(d.value);h.value&&(console.log(h.value.data.errors[0].defaultMessage),T(h.value.data.errors)),console.log(b.value);const j=async s=>{s.trim().split(/[()]/)[1].length<=2?(n.value.rightcode=s.trim().split(/[()]/)[1],n.value.rightno=g.value.pid):(n.value.rightcode=null,n.value.rightno=null)};if((l=b.value)!=null&&l.claimCode){await j(g.value.subInscl),n.value.pcucode=t.value.pcucodeperson,n.value.pid=t.value.pid.toString(),n.value.hosmain=(e=g.value.hospMain)!=null&&e.hcode?(o=g.value.hospMain)==null?void 0:o.hcode:t.value.hosmain,n.value.hossub=t.value.hossub,n.value.username="adm",n.value.claimcode_nhso=b.value.claimCode,n.value.claimcode_type=b.value.claimType,n.value.datetime_claim=b.value.createdDate;const{data:s,pending:be,error:ce,refresh:ve}=await X(n.value);if((f=s.value)!=null&&f.ok&&(console.log(s),s.value.data.visitno)){const{data:w,pending:ye,error:me,refresh:fe}=await Y(s.value.data.visitno);(p=w.value)!=null&&p.ok&&(N.value=w.value.data,c.push("/qrcode"))}}}};return(l,e)=>(S(),$("div",null,[r("div",Z,[r("div",ee,[re,K(r("input",{type:"tel",id:"tel",ref_key:"tel",ref:m,"onUpdate:modelValue":e[0]||(e[0]=o=>U(a)?a.value=o:null),maxlength:"10",class:"border border-gray-300 text-gray-900 text-4xl rounded-lg focus:ring-green-600 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"",required:""},null,512),[[L,_(a)]])]),r("div",oe,[r("button",{onClick:e[1]||(e[1]=o=>i("1")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 1 "),r("button",{onClick:e[2]||(e[2]=o=>i("2")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 2 "),r("button",{onClick:e[3]||(e[3]=o=>i("3")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 3 "),r("button",{onClick:e[4]||(e[4]=o=>i("4")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 4 "),r("button",{onClick:e[5]||(e[5]=o=>i("5")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 5 "),r("button",{onClick:e[6]||(e[6]=o=>i("6")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 6 "),r("button",{onClick:e[7]||(e[7]=o=>i("7")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 7 "),r("button",{onClick:e[8]||(e[8]=o=>i("8")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 8 "),r("button",{onClick:e[9]||(e[9]=o=>i("9")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 9 "),te,r("button",{onClick:e[10]||(e[10]=o=>i("0")),type:"button",class:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," 0 "),r("button",{onClick:B,type:"button",class:"text-gray-900 bg-white border border-gray-300 rounded-tl-4xl rounded-bl-4xl focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-2xl px-5 py-2.5 mr-2 mb-2 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700"}," ลบ ")])]),r("div",ae,[r("button",{onClick:P,disabled:_(v),type:"button",class:"text-white mt-48 items-center bg-palette-bt-green border-2 border-black hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-normal rounded-lg text-6xl px-14 py-7 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"}," ต่อไป ",8,ne)])]))}}),ie={},de=r("button",{type:"button",class:"m-5 px-10 py-3 text-5xl font-medium text-center opacity-95 text-white bg-palette-bt-gray rounded-lg hover:bg-gray-700 focus:ring-2 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"}," กลับ ",-1);function ue(M,m){const a=A,t=F,c=G,v=le;return S(),$(O,null,[y(a),y(t,{to:"/"},{default:J(()=>[de]),_:1}),y(c),y(v)],64)}const Ve=H(ie,[["render",ue]]);export{Ve as default};
